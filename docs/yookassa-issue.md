# Проблема с авторизацией в YooKassa API

## Обнаруженная проблема

При попытке подключения к API YooKassa возникает ошибка авторизации (401 Unauthorized). Ключевое сообщение об ошибке:

```
- ОШИБКА АВТОРИЗАЦИИ: Неверный идентификатор магазина или секретный ключ
- Проверьте настройки YOOKASSA_SHOP_ID и YOOKASSA_SECRET_KEY в файле .env
- У вас используется тестовый ключ (начинается с test_)
- Проверьте, что ваш shopId также является тестовым (должен начинаться с цифры 5)
- Тестовый shopId и тестовый ключ должны быть получены в личном кабинете ЮКассы, раздел "Настройки" → "API" → "Тестовые платежи"
```

## Результаты диагностики

1. Текущие настройки:
   - **Shop ID:** 1078751 (обычный, не тестовый ID)
   - **Secret Key:** test_N4j0beFbm9WI95UYeTnHmgMx7nPZ0o_xdHT_inISfB (тестовый ключ)
   - **Test Mode:** true (включен тестовый режим)

2. Несоответствие:
   - Используется тестовый ключ (начинается с `test_`)
   - Но используется боевой ID магазина (не начинается с цифры 5)

## Рекомендации по исправлению

Существует два возможных решения:

### Вариант 1: Использовать тестовый режим (рекомендуется для разработки)

1. Войдите в личный кабинет YooKassa
2. Перейдите в раздел "Настройки" → "API" → "Тестовые платежи"
3. Получите тестовый Shop ID (должен начинаться с цифры 5) и тестовый секретный ключ
4. Обновите файл `.env`:
   ```
   YOOKASSA_SHOP_ID=5xxxxxxx
   YOOKASSA_SECRET_KEY=test_xxxxxxxxxxxxxxx
   YOOKASSA_TEST_MODE=true
   ```

### Вариант 2: Использовать боевой режим (для продакшена)

1. Получите боевой секретный ключ в личном кабинете YooKassa (раздел "Настройки" → "API")
2. Обновите файл `.env`:
   ```
   YOOKASSA_SHOP_ID=1078751
   YOOKASSA_SECRET_KEY=live_xxxxxxxxxxxxxxx
   YOOKASSA_TEST_MODE=false
   ```

## Важные замечания

- В тестовом режиме все платежи только имитируются, реальное списание средств не происходит
- Для тестового режима нужно использовать пару "тестовый ID + тестовый ключ"
- Для боевого режима нужно использовать пару "боевой ID + боевой ключ"
- Смешивание тестового ключа с боевым ID (или наоборот) приводит к ошибке авторизации

## Полезные ссылки

- [Документация YooKassa по авторизации](https://yookassa.ru/developers/using-api/authorization)
- [Документация YooKassa по тестовому режиму](https://yookassa.ru/developers/using-api/testing-and-production) 